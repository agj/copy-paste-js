var when = function (pred) { return function (f) { return function (a) { return pred(a) ? f(a) : a } } };